<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hedef Vurma Oyunu</title>

    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f0f4f9;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            position: relative;
            flex-direction: column;
        }

        h1 {
            color: #4CAF50;
            font-size: 2rem;
        }

        #score {
            font-size: 1.5rem;
            margin: 20px;
        }

        .target {
            position: absolute;
            width: 50px;
            height: 50px;
            background-color: #f44336;
            border-radius: 50%;
            cursor: pointer;
        }

        button {
            padding: 15px 30px;
            font-size: 1.2rem;
            margin-top: 30px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            background-color: #4CAF50;
            color: white;
        }

        button:hover {
            transform: scale(1.1);
            box-shadow: 0px 5px 15px rgba(0, 0, 0, 0.1);
        }

    </style>
</head>
<body>

    <h1>Hedef Vurma Oyunu</h1>
    <div id="score">Puan: 0</div>
    <div id="gameArea" style="width: 80%; height: 70%; position: relative; background-color: #fff; border: 2px solid #ccc;"></div>
    <button onclick="startGame()">Oyunu Başlat</button>

    <script>
        let score = 0;
        let gameStarted = false;
        let gameInterval;
        let targetInterval;
        let targets = [];

        // Kullanıcı adını localStorage'dan al
        const username = localStorage.getItem('username');
        if (!username) {
            alert("Kullanıcı adı bulunamadı, lütfen giriş yapın.");
            window.location.href = 'index.html';  // Eğer kullanıcı adı yoksa, giriş sayfasına yönlendir
        }

        // Oyunu başlat
        function startGame() {
            if (gameStarted) return; // Eğer oyun zaten başladıysa tekrar başlatmasın

            score = 0; // Puanı sıfırla
            document.getElementById('score').innerText = `Puan: ${score}`;
            gameStarted = true;

            // Hedefleri rastgele yerleştiren interval başlat
            targetInterval = setInterval(createTarget, 1000);

            // 30 saniye sonra oyunu bitir
            gameInterval = setTimeout(endGame, 30000); // 30 saniye
        }

        // Hedef oluştur
        function createTarget() {
            const target = document.createElement('div');
            target.classList.add('target');
            const gameArea = document.getElementById('gameArea');
            
            // Hedef rastgele bir yer seçiyor
            const x = Math.random() * (gameArea.offsetWidth - 50);
            const y = Math.random() * (gameArea.offsetHeight - 50);
            
            target.style.left = `${x}px`;
            target.style.top = `${y}px`;
            gameArea.appendChild(target);

            // Hedefin hareket yönünü rastgele seçiyoruz
            const randomDirection = getRandomDirection();
            targets.push({target, direction: randomDirection});

            target.addEventListener('click', () => {
                score += 10; // Hedefe tıklayınca 10 puan ekle
                document.getElementById('score').innerText = `Puan: ${score}`;
                target.remove(); // Hedefi sil
            });

            // Hedef belli bir süre sonra kaybolur
            setTimeout(() => target.remove(), 1500);
        }

        // Hedefin rastgele hareket yönünü seçme fonksiyonu
        function getRandomDirection() {
            const directions = ['up', 'down', 'left', 'right'];
            return directions[Math.floor(Math.random() * directions.length)];
        }

        // Hedeflerin hareketini sağla
        function moveTargets() {
            targets.forEach(item => {
                const target = item.target;
                const direction = item.direction;
                const speed = 6; // Hedeflerin hızını 3 kat artırdık (önceden 2 idi, şimdi 6 oldu)

                // Hedefin mevcut pozisyonunu alalım
                let top = parseInt(target.style.top);
                let left = parseInt(target.style.left);

                // Yönlere göre hareket etmesini sağla
                if (direction === 'up') {
                    top -= speed;
                } else if (direction === 'down') {
                    top += speed;
                } else if (direction === 'left') {
                    left -= speed;
                } else if (direction === 'right') {
                    left += speed;
                }

                // Hedefin ekran dışına çıkmaması için sınır kontrolleri
                if (top < 0) top = 0;
                if (top > window.innerHeight - 50) top = window.innerHeight - 50;
                if (left < 0) left = 0;
                if (left > window.innerWidth - 50) left = window.innerWidth - 50;

                // Yeni pozisyonu uygulayalım
                target.style.top = `${top}px`;
                target.style.left = `${left}px`;

                // Yönü tekrar değiştir (rastgele yön değişimi)
                if (Math.random() < 0.01) {
                    item.direction = getRandomDirection(); // Yönü rastgele değiştir
                }
            });
        }

        // Oyun bittiğinde
        function endGame() {
            clearInterval(targetInterval); // Hedefleri durdur
            alert(`Oyun Bitti! Kazandığınız Puan: ${score}`);

            // Puanı localStorage'a kaydet
            localStorage.setItem('lastScore', score);

            gameStarted = false; // Oyunu bitir
        }

        // Hedeflerin hareketini sürekli güncelle
        setInterval(moveTargets, 20);
    </script>

</body>
</html>
