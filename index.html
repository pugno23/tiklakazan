<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tıkla Kazan Sistemi - Giriş</title>

    <script type="module">
        // Firebase SDK importları
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.0/firebase-app.js";
        import { getFirestore, doc, setDoc, getDoc } from "https://www.gstatic.com/firebasejs/11.6.0/firebase-firestore.js";

        // Firebase yapılandırma
        const firebaseConfig = {
            apiKey: "AIzaSyBV5XYoidy49DKmVbx269Ri-039eCyxjYk",
            authDomain: "tiklakazan-5f61a.firebaseapp.com",
            projectId: "tiklakazan-5f61a",
            storageBucket: "tiklakazan-5f61a.firebasestorage.app",
            messagingSenderId: "867213315462",
            appId: "1:867213315462:web:287c994f0feaa3658a3007",
            measurementId: "G-19F7L7X2HH"
        };

        // Firebase'i başlat
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // Kullanıcı adı alımı
        let username = prompt("Lütfen kullanıcı adınızı girin:"); // Kullanıcıdan isim alıyoruz.

        // Kullanıcı verisi Firestore'dan alınır
        async function getUserData() {
            if (username) {
                const userRef = doc(db, "users", username);
                const docSnap = await getDoc(userRef);

                if (docSnap.exists()) {
                    // Kullanıcı zaten var, verileri alabiliriz.
                    console.log("Kullanıcı verisi bulundu.");
                } else {
                    // Kullanıcı verisi bulunmazsa yeni bir kullanıcı kaydet
                    console.log("Kullanıcı verisi bulunamadı, yeni kullanıcı oluşturulacak.");
                    await setDoc(doc(db, "users", username), {
                        clickCount: 0, // Başlangıçtaki clickCount
                        totalEarnings: 0 // Başlangıçtaki kazanç
                    });
                }

                // Firebase'e kullanıcı adı ve bilgilerini kaydetmek tamamlandığında yönlendirme işlemi
                window.location.href = 'game.html'; // Oyun sayfasına yönlendirme
            }
        }

        // Sayfa yüklendiğinde kullanıcı verisini al ve yönlendirme yap
        window.onload = function() {
            getUserData();
        };
    </script>
</head>
<body>
    <h1>Tıkla Kazan Sistemi - Giriş</h1>
    <p>Uygulamayı kullanabilmek için lütfen kullanıcı adınızı girin.</p>

    <p id="loadingMessage">Yükleniyor...</p> <!-- Yükleniyor mesajı gösterilecektir -->
</body>
</html>
